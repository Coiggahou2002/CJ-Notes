# 设计模式

## 概念

聚合：只要 B 类持有 A 类的实例，那么 A 类和 B 类之间就是聚合关系.

## UML 图

![](https://cjpark-1304138896.cos.ap-guangzhou.myqcloud.com/note_img/image-20210702204422331.png)

## 类的设计技巧

**1.保证数据私有**

确保他人在使用数据时必须通过 `Getter` 而不是直接调用，因为随着需求的改变，数据的具体形式可能发生变化，我们需要对使用数据的人隐藏数据定义和存储的具体细节.

**2.对字段进行显式初始化**

尽量避免依赖类字段的默认初始化，显示初始化以增强可读性.

**3.不要使用过多的的基本类型字段**

尽量将每若干字段封装成类，类套类.

**4.不是所有的字段都需要访问器和修改器**

看清楚，希望对外隐藏的字段不要设置 `Getter` 和 `Setter`.

**5.分解有过多职责的类**

换句话说，尽量使每个类职责单一.

**6.类名和方法应该体现他们的功能**

**7.优先使用不可变类（考虑线程安全）**

## OOP 基本原则

+ 对扩展开放，对修改关闭
+ 必须保证父类所有的性质在子类中成立（子类尽量不要重写父类方法）
+ 面向接口编程，而不是面向实现编程
+ 控制类的小粒度（责任单一）
+ 为各个类建立它们需要的专用接口
+ 迪米特？
+ 合成复用？

## 迭代器模式

> 使用迭代器对集合进行操作，将对集合的遍历行为与具体实现分离。

```java
public interface Iterator {
    public boolean abstract hasNext();
    public Object abstract next(); // returnCurrentElementAndAdvanceToNextPosition
}
```

注意此处的 `next()` 方法的功能是：返回迭代器当前所指的对象，并且让迭代器向前移动一位。

## 工厂模式

> 创建对象的方法比较复杂，希望通过 Factory 对外隐藏创建对象的细节.

### 简单工厂模式

背景：对象的构造代码复杂冗长， 若在对象本身的构造方法中内置这部分代码，会出现大量冗余.

使用一个工厂类，内置创建方法，专门用来创建一类对象，如果这个对象有子类，那么就在传入参数时确定好对象的子类型。

### 工厂方法模式

背景：现已有专门用于创建对象的工厂，但可扩展性差，当对象子类越来越多时，工厂内部对构造不同对象的分类操作又会变复杂，又会产生大量冗余代码，所以需要进一步抽象.

将工厂的基本操作抽象，将工厂类变成接口，然后对于每种不同的子类对象，去实现一个“专门生产该子类对象”的具体工厂，要求**该具体工厂必须实现工厂类的接口**.

**每个子类对象对应一个工厂子类，利用多态特性创建子类工厂，就是工厂方法模式.**

